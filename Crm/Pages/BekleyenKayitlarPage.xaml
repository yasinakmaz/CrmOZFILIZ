<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Crm.Pages.BekleyenKayitlarPage"
             xmlns:services="clr-namespace:Crm.Services"
             xmlns:md="http://schemas.enisn-projects.io/dotnet/maui/uraniumui/material"
             xmlns:vm="clr-namespace:Crm.ViewModels"
             Style="{StaticResource StlPage}"
             Title="Bekleyen KayÄ±tlar">

    <Grid x:Name="GrdShow">
        <CollectionView ItemsSource="{Binding GroupedItems}" IsGrouped="True">
            <CollectionView.GroupHeaderTemplate>
                <DataTemplate>
                    <Grid>
                        <Frame BackgroundColor="LightGray" Padding="10" CornerRadius="5">
                            <Grid ColumnDefinitions="*,Auto">
                                <Label Text="{Binding GroupName}" FontSize="16" FontAttributes="Bold" VerticalOptions="Center" />
                                <ImageButton Source="{Binding ArrowIcon}" WidthRequest="24" HeightRequest="24"
                                     Command="{Binding Source={RelativeSource AncestorType={x:Type vm:WaiterViewModel}}, Path=ToggleGroupCommand}"
                                     CommandParameter="{Binding}" Grid.Column="1"/>
                            </Grid>
                        </Frame>
                    </Grid>
                </DataTemplate>
            </CollectionView.GroupHeaderTemplate>

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10" Margin="5" HasShadow="True" IsVisible="{Binding IsExpanded, Source={RelativeSource AncestorType={x:Type vm:WaiterGroup}}}">
                        <StackLayout>
                            <Label Text="{Binding BusinessAuthNameAndSurname}" FontSize="14" FontAttributes="Bold"/>
                            <Label Text="{Binding BusinessProblem}" FontSize="12" TextColor="Gray"/>
                        </StackLayout>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>
    </Grid>
    
</ContentPage>